<html>
    <head>
        <link rel="stylesheet" href="/assets/css/chart.css">
   

    </head>
    <body>
        {{#winfo}}

        <div class="row">
            <div class="col-auto  ">
                <div class="info-box">
                    <span class="info-box-icon bg-info elevation-1"><i class="fa fa-file-invoice "></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">Заказов  </span>
                        <span class="info-box-number">
                            {{biorders}}

                        </span>
                    </div>
                    <!-- /.info-box-content -->
                </div>
                <!-- /.info-box -->
            </div>

            <div class="col-auto  ">
                <div class="info-box">
                    <span class="info-box-icon bg-success elevation-1"><i class="fa  fa-pallet"></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">ТМЦ на складе</span>
                        <span class="info-box-number">
                            На сумму  {{biitemscnt}}


                        </span>
                    </div>

                </div>
                <!-- /.info-box -->
            </div>
            
           <div class="col-auto ">
                <div class="info-box">
                    <span class="info-box-icon bg-success elevation-1"><i class="fa fa-money-bill"></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">Наличные</span>
                        <span class="info-box-number">
                            На сумму  {{binal}}


                        </span>
                    </div>

                </div>
                <!-- /.info-box -->
            </div>
             <div class="col-auto ">
                <div class="info-box">
                    <span class="info-box-icon bg-success elevation-1"><i class="fa fa-credit-card "></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">Безналичные</span>
                        <span class="info-box-number">
                            На сумму  {{bibeznal}}


                        </span>
                    </div>

                </div>
                <!-- /.info-box -->
            </div>
          
            
            <div class="col-auto  ">
                <div class="info-box">
                    <span class="info-box-icon bg-success elevation-1"><i class="fa fa-sign-out-alt"></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">К оплате</span>
                        <span class="info-box-number">
                            На сумму  {{bicredit}}


                        </span>
                    </div>

                </div>
                <!-- /.info-box -->
            </div>
            <div class="col-auto ">
                <div class="info-box">
                    <span class="info-box-icon bg-success elevation-1"><i class="fa fa-sign-in-alt "></i></span>

                    <div class="info-box-content">
                        <span class="info-box-text">Ожидается  оплата</span>
                        <span class="info-box-number">
                            На сумму  {{bidebet}}


                        </span>
                    </div>

                </div>
                <!-- /.info-box -->
            </div>


        </div>
        {{/winfo}}

        {{#wgraph}}

        <div class="row">

            <div   class="col-12  col-lg-4   ">
                <div   class="card ">
                    <div   class="card-body">

                        <canvas style="width:100%" id="paystructure"></canvas>
                    </div>
                </div>  
            </div>

            <div   class="col-12  col-lg-4 ">
                <div   class="card ">
                    <div   class="card-body">

                        <canvas style="width:100%" id="paycompare"></canvas>
                    </div>
                </div>    
            </div>
            <div   class="col-12  col-lg-4 ">
                <div   class="card ">
                    <div   class="card-body">

                        <canvas style="width:100%" id="sellstat"></canvas>
                    </div>
                </div>    
            </div>
        </div>     
        {{/wgraph}}    

        <div class="row">  


            {{#wsdate}}
            <div   class="col-12 col-lg-6 ">

                <div   class="card ">
                    <div   class="card-body">
                        <h4>Просроченные товары</h4>
                        <small>Товары для которых истек или истекает срок годности</small>
                        <br><a zippy="sdcsv">Экспорт в  Excel</a>
                        <table class="table   table-sm">
                            <tr>

                                <th>Склад</th>
                                <th>Товар</th>
                                <th>Серия</th>
                                <th>Годен до</th>
                                <th class="text-right">Кол.</th>
                            </tr>
                            <tr zippy="sdlist" >
                                <td zippy="wsd_storename"></td>
                                <td zippy="wsd_itemname"></td>
                                <td zippy="wsd_snumber"></td>
                                <td><span zippy="wsd_edate"></span></td>
                                <td zippy="wsd_qty" class="text-right"></td>
                            </tr>
                        </table>
                        <div zippy="sdpag" ></div>               

                    </div>
                </div>
            </div>
            {{/wsdate}}
            {{#wminqty}}
            <div   class="col-12 col-lg-6 ">

                <div   class="card ">
                    <div   class="card-body">
                        <h4>Минимальное количество</h4>
                        <small>Товары для которых задано минимальное количество на складе и актуальное количество меньше заданного</small>
                        <br><a zippy="mqcsv">Экспорт в  Excel</a>
                        <table class="table   table-sm">
                            <tr>
                              
                                <th>Склад</th>
                                <th>Товар</th>
                                <th>Код</th>

                                <th class="text-right">Факт</th>
                                <th class="text-right">Мин.</th>
                            </tr>
                            <tr zippy="mqlist">
                        
                                <td zippy="wmq_storename"></td>
                                <td zippy="wmq_itemname"></td>
                                <td zippy="wmq_item_code"></td>
                                <td zippy="wmq_qty" class="text-right"></td>
                                <td zippy="wmq_minqty" class="text-right"></td>
                            </tr>
                        </table>             
                        <div zippy="mqpag"></div>        
                    </div>
                </div>
            </div>      
            {{/wminqty}}


            {{#wrdoc}}
            <div   class="col-12 col-lg-6 ">

                <div   class="card ">
                    <div   class="card-body">
                        <h4>Недавние документы</h4>
                        <small>Документы с недавно измененным статусом</small>
                        <br><a zippy="rdcsv">Экспорт в  Excel</a>
                        <table class="table   table-sm">
                            <tr>
                                <th>Номер</th>
                                <th>Тип</th>
                                <th>Статус</th>
                                <th class="text-right">Сумма</th>
                                <th>Изменил</th>
                                <th>Дата</th>
                                

                            </tr>
                            <tr zippy="rdoclist">
                                <td><a zippy="wrd_number"></a></td>
                                <td zippy="wrd_type"></td>
                                <td zippy="wrd_state"></td>
                                <td class="text-right" zippy="wrd_amount"></td>
                                <td zippy="wrd_user"></td>
                                <td zippy="wrd_date"></td>
                                
                            </tr>
                        </table>
                        <div zippy="wrpag"></div>    
                    </div>
                </div>
            </div>      
            {{/wrdoc}}
      {{#wmdoc}}
            <div   class="col-12 col-lg-6 ">

                <div   class="card ">
                    <div   class="card-body">
                        <h4>Мои документы</h4>
                        <small>Документы, созданные текушим  пользователем</small>
                        <br><a zippy="mdcsv">Экспорт в  Excel</a>
                        <table class="table   table-sm">
                            <tr>
                                <th>Номер</th>
                                <th>Тип</th>
                                <th>Дата</th>
                                <th class="text-right">Сумма</th>

                            </tr>
                            <tr zippy="mdoclist">
                                <td><a zippy="wmd_number"></a></td>
                                <td zippy="wmd_type"></td>
                                <td zippy="wmd_date"></td>
                                <td class="text-right" zippy="wmd_amount"></td>
                            </tr>
                        </table>
                        <div zippy="wmpag"></div>    
                    </div>
                </div>
            </div>      
            {{/wmdoc}}


        </div>  
        


        <script   src="/assets/js/chart.js"></script>

        <script>
        
       var fontcolor='#000' ;
        {{#darkmode}}
            fontcolor='#fff' ;
        {{/darkmode}}        
        
        
//структура   расходов
var pieData = {
labels: {{{pbtitle}}},
        datasets: [
        {
        data: {{{pbdata}}},
                backgroundColor : {{{pbcolor}}},
        }
        ]
        }


var pieOptions = {
maintainAspectRatio : false,
        responsive : true,
        title: {
        display: true,
                text: 'Структура расходов за  три месяца',   fontColor: fontcolor,
                position: 'top'

        },
        legend: {
        display: true,
                position: 'right',
                labels: {
                boxWidth: 10,
                        fontColor: fontcolor,
                        padding:  5
                }
        },
        tooltips: {
        enabled: true
        },
        }

//сравнение  доходоа  и расходов




var barData = {
labels: {{{pcmon}}},
        datasets: [
        {
        label: "Расход",
                backgroundColor: "red",
                data: {{{pcout}}}
        }, {
        label: "Доход",
                backgroundColor: "green",
                data: {{{pcin}}}
        }
        ]
        }


var barOptions = {
legend: {
display: true,   
        position: 'right',
         labels: {
                
                        fontColor: fontcolor 
                        
                }
        },
        title: {
        display: true,      fontColor: fontcolor,
                text: 'Доходы  и расходы'
        }  ,
        
        scales: {
        xAxes: [{
             ticks: { 
                   fontColor: fontcolor 
             } 
        }],
                yAxes: [{    ticks: { 
                   fontColor: fontcolor 
             } 
                }]
        }        
        
}


var sellData = {
labels  : {{{tsmon}}},
        datasets: [
        {
        label               : 'Товары',
                backgroundColor         : 'rgba(60,141,188,0.8)',
                borderColor         : 'rgba(60,141,188,0.8)',
                fill          : false,
                data                :  {{{tstov}}}
        },
        {
        label               : 'Услуги',
                backgroundColor         : 'rgba(210, 100, 100, 1)',
                borderColor         : 'rgba(210, 100, 100, 1)',
                fill          : false,
                data                :  {{{tsser}}}
        },
        ]
        }






var sellOptions = {
title: {
display: true,     fontColor: fontcolor,
        text: 'Реализация'
        },
legend: {
   labels: {
                
                        fontColor: fontcolor 
                        
                }
      
        },        
        
        
        scales: {
        xAxes: [{
             ticks: { 
                   fontColor: fontcolor 
             },
            
            
        gridLines : {
        display : false,
        }
        }],
                yAxes: [{    ticks: { 
                   fontColor: fontcolor 
             },
                gridLines : {
                display : false,
                }
                }]
        }
}

window.onload = function() {


new Chart(document.querySelector('#paystructure'), {
type: 'pie',
        data: pieData,
        options: pieOptions
        })

        new Chart(document.querySelector('#paycompare'), {
        type: 'bar',
                data: barData,
                options: barOptions
        })

        new Chart(document.querySelector('#sellstat'), {
        type: 'line',
                data: sellData,
                options: sellOptions
        })


        };




        </script>

    </body>
</html>
